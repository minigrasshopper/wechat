!function(){function a(a,e){function t(a){var e=a.error-0;switch(M.loadingHide(),e){case 1002:oAuth.clear(),changeAlert("你的身份信息已过期，点击确定刷新页面"),window.location.reload();break;default:changeAlert(a.error_msg)}}function o(a,e,o){M.ajax(a,e,config.gameid,function(a){var e=a.error-0;switch(e){case 0:o&&o(a);break;default:t(a)}},config.apiopenid,config.apitoken,config.isDebug?"nf":"")}function n(e,t){switch(e.link=config.htmlUrl+"index.html?channelid="+sessionStorage.getItem("channelid"),localStorage.language){case"cn":break;case"en":languagePack[e.title]&&(e.title=languagePack[e.title]),languagePack[e.desc]&&(e.desc=languagePack[e.desc])}a.initWx(e,config.gameid,config.apiopenid,config.apitoken,t,null,null,null)}var i=getUrlParam().channelid?getUrlParam().channelid:"";sessionStorage.setItem("channelid",i),console.log(sessionStorage.getItem("channelid")),amendPageStyle();var l={goodsCate:function(a){o("mall/goods/cate",{},function(e){a&&a(e)})},goodsList:function(a,e){o("mall/goods/list",a,function(a){e&&e(a)})}};new Vue({el:"section",beforeCreate:function(){var a=2592e5;if(localStorage.city){var e=(new Date).getTime();e-localStorage.preTime>a&&(localStorage.city="",localStorage.preTime=(new Date).getTime())}else localStorage.preTime=(new Date).getTime()},data:{pageData:[],cateArr:sessionStorage.getItem("cateArr")?JSON.parse(sessionStorage.getItem("cateArr")):null,cartNum:localStorage.cartNum?localStorage.cartNum:null,lang_cn:localStorage.language,params:{categoryid:null,keyword:null},city:"",showAll:1==localStorage.showAll?1:0,cityBoxShow:localStorage.city?!1:!0,cityList:[{city:"北京",showAll:1},{city:"其他",showAll:0}]},mounted:function(){var a=this;M.loading(),check(oAuth,function(){a.init()})},updated:function(){changeLanguage(),nameFontChange();var a=$(".goodListLimit");$.each(a,function(a,e){var t=$(e).find("li");if(t.length>4){$(t).hide();for(var o=0;4>o;o++)$(t).eq(o).show()}})},methods:{init:function(){var a=this;this.$el.style.display="block",this.swiperSize(),new e(".swiper-container",{autoplay:2e3,loop:!0,pagination:".pagination"}),l.goodsList(null,function(e){console.log(e),a.pageData=e.goods,changeLanguage(),M.loadingHide(),a.cartNum?a.cateArr?n(config.shareInfo):(M.loading(),l.goodsCate(function(e){a.cateArr=e.cates,sessionStorage.setItem("cateArr",JSON.stringify(a.cateArr)),M.loadingHide(),a.cartNum?n(config.shareInfo):(M.loading(),getCartNum("mall/cart/list",{},function(e){a.cartNum=e.length,localStorage.cartNum=a.cartNum,M.loadingHide(),n(config.shareInfo)}))})):(M.loading(),getCartNum("mall/cart/list",{},function(e){a.cartNum=e.length,localStorage.cartNum=a.cartNum,M.loadingHide(),a.cateArr?n(config.shareInfo):(M.loading(),l.goodsCate(function(e){a.cateArr=e.cates,sessionStorage.setItem("cateArr",JSON.stringify(a.cateArr)),M.loadingHide(),n(config.shareInfo)}))}))}),console.log(a.cateArr)},swiperSize:function(){var a=$("body").width();$(".swiper-container").height(400*a/640)},inputHandle:function(a){var e=this;e.pageData=[];var t=a.currentTarget;this.params.keyword=$(t).val(),l.goodsList(this.params,function(a){e.pageData=a.goods})},jumpGoodDetail:function(a){gotoUrl("good-detail.html?goodsId="+a)},jumpGoodList:function(a,e){gotoUrl("good-list.html?name="+a+"&category_id="+e)},toggleLang:function(a){this.lang_cn=a,localStorage.language=a,gotoUrl(config.htmlUrl+"index.html?md5="+new Date)},selectCity:function(a,e){this.city=a,this.showAll=e,localStorage.city=a,localStorage.showAll=e},cityHandle:function(){this.city?this.cityBoxShow=!1:changeAlert("请选择")}}})}require([config.configUrl],function(){var e=["wxshare","swiper"];require(e,a)})}();